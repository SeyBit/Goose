            ],
            yellow: [ // Drapeaux
                { q: "De quel pays est le drapeau bleu-blanc-rouge vertical?", a: "France" },
                { q: "Combien d'étoiles sur le drapeau américain?", a: "50" },
                { q: "Quelle forme a le drapeau du Népal?", a: "Triangulaire" },
                { q: "De quelle couleur est le cercle du drapeau japonais?", a: "Rouge" },
                { q: "Combien de bandes a le drapeau allemand?", a: "3" },
                { q: "Quelle feuille est sur le drapeau canadien?", a: "Érable" },
                { q: "De quelle couleur est la croix du drapeau suisse?", a: "Blanche" },
                { q: "Combien de couleurs sur le drapeau italien?", a: "3" },
                { q: "Quel animal est sur le drapeau mexicain?", a: "Aigle" },
                { q: "De quelle couleur est le drapeau de la Libye?", a: "Vert" },
                { q: "Combien d'étoiles sur le drapeau européen?", a: "12" },
                { q: "Quel symbole est au centre du drapeau indien?", a: "Roue" },
                { q: "De quelles couleurs est le drapeau belge?", a: "Noir jaune rouge" },
                { q: "Quel pays a un dragon sur son drapeau?", a: "Bhoutan" },
                { q: "Combien de rayures sur le drapeau américain?", a: "13" },
                { q: "De quelle couleur est la croix du drapeau danois?", a: "Blanche" },
                { q: "Quel pays a un soleil sur son drapeau?", a: "Argentine" },
                { q: "Combien de triangles sur le drapeau britannique?", a: "8" },
                { q: "De quelle couleur est le fond du drapeau turc?", a: "Rouge" },
                { q: "Quel pays a un cèdre sur son drapeau?", a: "Liban" },
                { q: "Combien de couleurs sur le drapeau sud-africain?", a: "6" },
                { q: "Quel symbole est sur le drapeau israélien?", a: "Étoile de David" },
                { q: "De quelles couleurs est le drapeau grec?", a: "Bleu et blanc" },
                { q: "Quel pays a un aigle à deux têtes?", a: "Albanie" },
                { q: "Combien de bandes sur le drapeau grec?", a: "9" },
                { q: "De quelle couleur est le fond du drapeau chinois?", a: "Rouge" },
                { q: "Quel pays a une harpe sur son drapeau?", a: "Irlande" },
                { q: "Combien de rayons a le soleil uruguayen?", a: "16" },
                { q: "De quelle couleur est le fond du drapeau marocain?", a: "Rouge" },
                { q: "Quel pays a un temple sur son drapeau?", a: "Cambodge" }
            ],
            purple: [ // Anime
                { q: "Qui est le héros de Dragon Ball?", a: "Goku" },
                { q: "Dans quel anime trouve-t-on des Titans?", a: "L'Attaque des Titans" },
                { q: "Qui est le ninja orange de Konoha?", a: "Naruto" },
                { q: "Quel est le nom du propriétaire du Death Note?", a: "Light Yagami" },
                { q: "Qui est le pirate au chapeau de paille?", a: "Luffy" },
                { q: "Comment s'appelle le rival de Goku?", a: "Vegeta" },
                { q: "Quel est le nom du démon renard dans Naruto?", a: "Kurama" },
                { q: "Qui est le plus fort des héros dans One Punch Man?", a: "Saitama" },
                { q: "Comment s'appelle le frère d'Edward Elric?", a: "Alphonse" },
                { q: "Quel est le nom de famille de Naruto?", a: "Uzumaki" },
                { q: "Qui est le capitaine du Thousand Sunny?", a: "Luffy" },
                { q: "Dans quel anime trouve-t-on des Shinigami?", a: "Bleach" },
                { q: "Comment s'appelle le maître de Goku?", a: "Kamé Sennin" },
                { q: "Quel est le rêve de Naruto?", a: "Devenir Hokage" },
                { q: "Qui est All Might?", a: "Le héros numéro 1" },
                { q: "Comment s'appelle le père de Goku?", a: "Bardock" },
                { q: "Quel est le nom du vaisseau de Végéta?", a: "Capsule Corp" },
                { q: "Dans quel anime trouve-t-on des alchimistes?", a: "Fullmetal Alchemist" },
                { q: "Qui est le roi des pirates?", a: "Gol D. Roger" },
                { q: "Comment s'appelle le sensei de Naruto?", a: "Kakashi" },
                { q: "Quel est le nom de l'épée de Zoro?", a: "Wado Ichimonji" },
                { q: "Dans quel anime trouve-t-on des Stands?", a: "JoJo's Bizarre Adventure" },
                { q: "Qui est le héros de Demon Slayer?", a: "Tanjiro" },
                { q: "Comment s'appelle le chat dans Fairy Tail?", a: "Happy" },
                { q: "Quel est le nom du guild de Natsu?", a: "Fairy Tail" },
                { q: "Dans quel anime trouve-t-on des Ghoules?", a: "Tokyo Ghoul" },
                { q: "Qui est le stratège dans Code Geass?", a: "Lelouch" },
                { q: "Comment s'appelle la sœur de Tanjiro?", a: "Nezuko" },
                { q: "Quel est le nom du notebook de Light?", a: "Death Note" },
                { q: "Dans quel anime trouve-t-on des mages?", a: "Fairy Tail" }
            ],
            brown: [ // Jeux vidéo
                { q: "Qui est la mascotte de Nintendo?", a: "Mario" },
                { q: "Dans quel jeu construit-on avec des blocs?", a: "Minecraft" },
                { q: "Qui est l'ennemi principal de Sonic?", a: "Dr. Robotnik" },
                { q: "Quel est le nom du héros de Zelda?", a: "Link" },
                { q: "Combien y a-t-il de Pokémon dans la 1ère génération?", a: "151" },
                { q: "Quel est le frère de Mario?", a: "Luigi" },
                { q: "Dans quel jeu combat-on des dragons?", a: "Skyrim" },
                { q: "Quel est le jeu de battle royale d'Epic Games?", a: "Fortnite" },
                { q: "Comment s'appelle la princesse dans Mario?", a: "Peach" },
                { q: "Quel est le premier Pokémon du Pokédex?", a: "Bulbizarre" },
                { q: "Dans quel jeu incarne-t-on Kratos?", a: "God of War" },
                { q: "Comment s'appelle le plombier vert?", a: "Luigi" },
                { q: "Quel est le nom du hérisson bleu?", a: "Sonic" },
                { q: "Dans quel jeu trouve-t-on des Creepers?", a: "Minecraft" },
                { q: "Qui est la princesse d'Hyrule?", a: "Zelda" },
                { q: "Quel est le Pokémon mascotte?", a: "Pikachu" },
                { q: "Dans quel jeu vole-t-on des voitures?", a: "GTA" },
                { q: "Comment s'appelle le singe de Nintendo?", a: "Donkey Kong" },
                { q: "Quel est le type de Pikachu?", a: "Électrique" },
                { q: "Dans quel jeu trouve-t-on des Endermen?", a: "Minecraft" },
                { q: "Qui est l'ennemi de Link?", a: "Ganon" },
                { q: "Comment s'appelle le dinosaure vert?", a: "Yoshi" },
                { q: "Quel est le nom du chasseur dans Metroid?", a: "Samus" },
                { q: "Dans quel jeu trouve-t-on des zombies?", a: "Resident Evil" },
                { q: "Qui est le rival de Mario dans Mario Kart?", a: "Bowser" },
                { q: "Quel est le nom du renard dans Sonic?", a: "Tails" },
                { q: "Dans quel jeu explore-t-on des donjons?", a: "Diablo" },
                { q: "Comment s'appelle l'île dans Animal Crossing?", a: "Variable" },
                { q: "Quel est le studio de Minecraft?", a: "Mojang" },
                { q: "Dans quel jeu trouve-t-on Master Chief?", a: "Halo" }
            ],
            orange: [ // Célébrités
                { q: "Qui a chanté 'Thriller'?", a: "Michael Jackson" },
                { q: "Qui a joué Iron Man au cinéma?", a: "Robert Downey Jr." },
                { q: "Qui a écrit Harry Potter?", a: "J.K. Rowling" },
                { q: "Qui a peint la Joconde?", a: "Léonard de Vinci" },
                { q: "Qui était surnommé 'The King' du rock?", a: "Elvis Presley" },
                { q: "Qui a réalisé Star Wars?", a: "George Lucas" },
                { q: "Qui a chanté 'Bohemian Rhapsody'?", a: "Queen" },
                { q: "Qui a joué Jack dans Titanic?", a: "Leonardo DiCaprio" },
                { q: "Qui a chanté 'Billie Jean'?", a: "Michael Jackson" },
                { q: "Qui a joué Harry Potter?", a: "Daniel Radcliffe" },
                { q: "Qui a peint Les Tournesols?", a: "Van Gogh" },
                { q: "Qui a réalisé Jurassic Park?", a: "Steven Spielberg" },
                { q: "Qui a chanté 'Imagine'?", a: "John Lennon" },
                { q: "Qui a joué le Joker dans The Dark Knight?", a: "Heath Ledger" },
                { q: "Qui a écrit Roméo et Juliette?", a: "Shakespeare" },
                { q: "Qui a chanté 'Shape of You'?", a: "Ed Sheeran" },
                { q: "Qui a joué Black Widow?", a: "Scarlett Johansson" },
                { q: "Qui a peint Guernica?", a: "Picasso" },
                { q: "Qui a réalisé Avatar?", a: "James Cameron" },
                { q: "Qui a chanté 'Hello'?", a: "Adele" },
                { q: "Qui a joué Hermione Granger?", a: "Emma Watson" },
                { q: "Qui a composé La 9ème Symphonie?", a: "Beethoven" },
                { q: "Qui a réalisé E.T.?", a: "Steven Spielberg" },
                { q: "Qui a chanté 'Poker Face'?", a: "Lady Gaga" },
                { q: "Qui a joué Spider-Man (Tom)?", a: "Tom Holland" },
                { q: "Qui a peint La Nuit Étoilée?", a: "Van Gogh" },
                { q: "Qui a écrit Le Petit Prince?", a: "Saint-Exupéry" },
                { q: "Qui a chanté 'Uptown Funk'?", a: "Bruno Mars" },
                { q: "Qui a joué Thor?", a: "Chris Hemsworth" },
                { q: "Qui a inventé Mickey Mouse?", a: "Walt Disney" }
            ],
            red: [ // Pièges - Questions difficiles
                { q: "Combien de secondes dans une journée?", a: "86400" },
                { q: "Quelle est la racine cubique de 729?", a: "9" },
                { q: "En quelle année a eu lieu la chute de Constantinople?", a: "1453" },
                { q: "Combien d'os dans le corps humain adulte?", a: "206" },
                { q: "Quelle est la vitesse de la lumière en km/s?", a: "300000" },
                { q: "Combien de pays dans l'Union Européenne?", a: "27" },
                { q: "Quelle est la température d'ébullition de l'eau en Celsius?", a: "100" },
                { q: "Combien de cartes dans un jeu standard?", a: "52" },
                { q: "Quelle est la racine carrée de 1764?", a: "42" },
                { q: "Combien de minutes dans une semaine?", a: "10080" },
                { q: "En quelle année Christophe Colomb a découvert l'Amérique?", a: "1492" },
                { q: "Combien de touches sur un piano?", a: "88" },
                { q: "Quelle est la distance Terre-Lune en km?", a: "384400" },
                { q: "Combien de lettres dans l'alphabet grec?", a: "24" },
                { q: "Quelle est la profondeur de la fosse des Mariannes en mètres?", a: "11000" },
                { q: "Combien de satellites naturels a Jupiter?", a: "79" },
                { q: "En quelle année a eu lieu la Révolution française?", a: "1789" },
                { q: "Combien de côtés a un dodécagone?", a: "12" },
                { q: "Quelle est la température du zéro absolu en Celsius?", a: "-273" },
                { q: "Combien de chromosomes a l'être humain?", a: "46" },
                { q: "En quelle année le Titanic a coulé?", a: "1912" },
                { q: "Combien de faces a un icosaèdre?", a: "20" },
                { q: "Quelle est la valeur de Pi à 5 décimales?", a: "3.14159" },
                { q: "Combien de vertèbres dans la colonne vertébrale?", a: "33" },
                { q: "En quelle année Neil Armstrong a marché sur la Lune?", a: "1969" },
                { q: "Combien de dents a un adulte?", a: "32" },
                { q: "Quelle est la masse de la Terre en kg (exposant)?", a: "24" },
                { q: "Combien de fuseaux horaires dans le monde?", a: "24" },
                { q: "En quelle année a eu lieu la chute du mur de Berlin?", a: "1989" },
                { q: "Combien de litres de sang dans le corps humain?", a: "5" }
        // Questions difficiles supplémentaires
        const hardQuestions = {
            blue: [ // Géographie difficile
                { q: "Quelle est la capitale du Bhoutan?", a: "Thimphou" },
                { q: "Combien d'îles composent l'archipel des Philippines?", a: "7641" },
                { q: "Quel est le point culminant de l'Afrique?", a: "Kilimandjaro" },
                { q: "Quelle est la capitale du Kazakhstan?", a: "Astana" },
                { q: "Quel est le plus long fleuve d'Europe?", a: "Volga" },
                { q: "Combien de fuseaux horaires en Russie?", a: "11" },
                { q: "Quelle est la capitale de la Mongolie?", a: "Oulan-Bator" },
                { q: "Quel est le lac le plus profond du monde?", a: "Baïkal" },
                { q: "Quelle est la capitale du Sri Lanka?", a: "Colombo" },
                { q: "Quel est le désert le plus aride du monde?", a: "Atacama" }
            ],
            green: [ // Calcul mental difficile
                { q: "Combien font 17³?", a: "4913" },
                { q: "Combien font 1728 ÷ 12?", a: "144" },
                { q: "Quelle est la racine carrée de 2304?", a: "48" },
                { q: "Combien font 37 × 43?", a: "1591" },
                { q: "Combien font 15% de 1340?", a: "201" },
                { q: "Combien font 2⁹?", a: "512" },
                { q: "Combien font 91 × 11?", a: "1001" },
                { q: "Quelle est la somme des 20 premiers nombres?", a: "210" },
                { q: "Combien font 3456 ÷ 16?", a: "216" },
                { q: "Combien font 23² + 17²?", a: "818" }
            ],
            yellow: [ // Drapeaux difficiles
                { q: "Combien de pays ont un dragon sur leur drapeau?", a: "3" },
                { q: "De quelle couleur est l'étoile du drapeau du Ghana?", a: "Noire" },
                { q: "Combien de langues sur le drapeau sud-africain?", a: "0" },
                { q: "Quel pays a le plus ancien drapeau encore utilisé?", a: "Danemark" },
                { q: "Combien de croix sur le drapeau géorgien?", a: "5" },
                { q: "Quelle est la proportion du drapeau japonais?", a: "2:3" },
                { q: "Quel pays a un temple d'Angkor sur son drapeau?", a: "Cambodge" },
                { q: "Combien de branches a l'étoile du drapeau marocain?", a: "5" },
                { q: "De quelle année date le drapeau olympique?", a: "1913" },
                { q: "Quel pays a un navire viking sur son drapeau?", a: "Islande" }
            ],
            purple: [ // Anime difficile
                { q: "En quelle année est sorti le premier Dragon Ball?", a: "1984" },
                { q: "Combien de membres dans l'Akatsuki complet?", a: "10" },
                { q: "Quel est le vrai nom de L dans Death Note?", a: "L Lawliet" },
                { q: "Combien de formes a Freezer?", a: "5" },
                { q: "Quel est le numéro de Saitama dans l'association?", a: "7" },
                { q: "Combien d'épisodes dans Dragon Ball Z?", a: "291" },
                { q: "Quel est le niveau de puissance de Goku SSJ3?", a: "400M" },
                { q: "En quelle année Naruto est devenu Hokage?", a: "2015" },
                { q: "Combien de portes peut ouvrir Guy?", a: "8" },
                { q: "Quel est le bounty actuel de Luffy?", a: "3 milliards" }
            ],
            brown: [ // Jeux vidéo difficile
                { q: "En quelle année est sorti le premier Mario?", a: "1981" },
                { q: "Combien de boss dans Dark Souls 1?", a: "26" },
                { q: "Quel est le record de vente de Minecraft?", a: "300M" },
                { q: "Combien de champions dans LoL à sa sortie?", a: "40" },
                { q: "Quel est le niveau max dans WoW Classic?", a: "60" },
                { q: "Combien de pixels de haut fait Mario?", a: "16" },
                { q: "En quelle année est sorti Pong?", a: "1972" },
                { q: "Combien de Korok Seeds dans Zelda BotW?", a: "900" },
                { q: "Quel est le score max théorique à Pac-Man?", a: "3333360" },
                { q: "Combien de tétrominoes différents dans Tetris?", a: "7" }
            ],
            orange: [ // Célébrités difficile
                { q: "En quelle année est né Albert Einstein?", a: "1879" },
                { q: "Combien d'Oscars a gagné Walt Disney?", a: "22" },
                { q: "Quel est le vrai nom de Marilyn Monroe?", a: "Norma Jean" },
                { q: "Combien de symphonies a composé Mozart?", a: "41" },
                { q: "En quelle année est mort Elvis Presley?", a: "1977" },
                { q: "Combien de tableaux a peint Van Gogh?", a: "900" },
                { q: "Quel âge avait Pelé à sa première Coupe du Monde?", a: "17" },
                { q: "Combien de Grammy Awards a Beyoncé?", a: "32" },
                { q: "En quelle année est né Léonard de Vinci?", a: "1452" },
                { q: "Combien de films a réalisé Hitchcock?", a: "53" }
            ],
            red: [ // Ultra difficile
                { q: "Quelle est la constante de Planck (exposant)?", a: "-34" },
                { q: "Combien d'atomes dans une mole?", a: "6.022×10²³" },
                { q: "Quelle est la température de Planck (exposant)?", a: "32" },
                { q: "Combien de décimales de Pi sont connues (milliards)?", a: "31415" },
                { q: "Quelle est la masse du proton en kg (exposant)?", a: "-27" },
                { q: "Combien de neurones dans le cerveau (milliards)?", a: "86" },
                { q: "Quelle est la pression au centre de la Terre (GPa)?", a: "360" },
                { q: "Combien de galaxies dans l'univers observable (milliards)?", a: "2000" },
                { q: "Quelle est la distance de Planck en mètres (exposant)?", a: "-35" },
                { q: "Combien d'espèces sur Terre (millions)?", a: "8.7" }
            ]
        };
        
        // État du jeu
        let gameState = {
            players: [],
            currentPlayer: 0,
            currentQuestion: null,
            currentTheme: null,
            currentDifficulty: 'normal',
            diceValue: 0,
            board: [],
            phase: 'setup',
            playerCount: 0,
            usedQuestions: new Set(),
            boardLayout: []
        };
        
        // Configuration des joueurs
        function setPlayerCount(count) {
            gameState.playerCount = count;
            const container = document.getElementById('playerSetupContainer');
            container.innerHTML = '';
            
            for (let i = 0; i < count; i++) {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player-setup';
                playerDiv.innerHTML = `
                    <label>Joueur ${i + 1}:</label>
                    <input type="text" id="playerName${i}" placeholder="Nom du joueur ${i + 1}" value="Joueur ${i + 1}">
                `;
                container.appendChild(playerDiv);
            }
            
            document.getElementById('startGameBtn').style.display = 'block';
        }
        
        // Démarrer une nouvelle partie
        function startNewGame() {
            gameState.players = [];
            gameState.usedQuestions = new Set();
            const icons = ['🔴', '🔵', '🟡', '🟢'];
            
            for (let i = 0; i < gameState.playerCount; i++) {
                const name = document.getElementById(`playerName${i}`).value || `Joueur ${i + 1}`;
                gameState.players.push({
                    id: i + 1,
                    name: name,
                    position: 0,
                    icon: icons[i],
                    score: 0,
                    correct: 0,
                    wrong: 0
                });
            }
            
            document.getElementById('setupModal').style.display = 'none';
            initBoard();
            updatePlayersInfo();
            showNextPlayerModal();
        }
        
        // Générer un plateau aléatoire
        function generateRandomBoard() {
            gameState.boardLayout = [];
            for (let i = 0; i < BOARD_SIZE; i++) {
                if (i === 0 || i === BOARD_SIZE - 1) {
                    gameState.boardLayout.push('special');
                } else if (SPECIAL_CELLS.includes(i)) {
                    gameState.boardLayout.push('special');
                } else if (CHOICE_CELLS.includes(i)) {
                    gameState.boardLayout.push('gold');
                } else {
                    // Exclure 'gold' des couleurs normales
                    const normalColors = CELL_COLORS.filter(c => c !== 'gold');
                    gameState.boardLayout.push(normalColors[Math.floor(Math.random() * normalColors.length)]);
                }
            }
        }
        
        // Initialisation du plateau
        function initBoard() {
            const board = document.getElementById('board');
            board.innerHTML = '';
            gameState.board = [];
            
            // Générer un nouveau plateau aléatoire
            generateRandomBoard();
            
            for (let i = 0; i < BOARD_SIZE; i++) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                cell.id = `cell-${i}`;
                
                if (i === 0) {
                    cell.classList.add('special');
                    cell.textContent = '🏁';
                } else if (i === BOARD_SIZE - 1) {
                    cell.classList.add('special');
                    cell.textContent = '🏆';
                } else if (gameState.boardLayout[i] === 'special') {
                    cell.classList.add('special');
                    cell.textContent = '⭐';
                } else if (gameState.boardLayout[i] === 'gold') {
                    cell.classList.add('gold');
                    cell.textContent = '❓';
                } else {
                    cell.classList.add(gameState.boardLayout[i]);
                    cell.textContent = i;
                }
                
                board.appendChild(cell);
                gameState.board.push(cell);
            }
            
            updatePlayerPositions();
        }
        
        // Obtenir une question non utilisée
        function getUnusedQuestion(theme, difficulty = 'normal') {
            const themeQuestions = difficulty === 'hard' && hardQuestions[theme] ? hardQuestions[theme] : questions[theme];
            const prefix = difficulty === 'hard' ? 'hard-' : '';
            const availableQuestions = themeQuestions.filter((q, index) => 
                !gameState.usedQuestions.has(`${prefix}${theme}-${index}`)
            );
            
            if (availableQuestions.length === 0) {
                // Si toutes les questions ont été utilisées, réinitialiser pour ce thème
                for (let i = 0; i < themeQuestions.length; i++) {
                    gameState.usedQuestions.delete(`${prefix}${theme}-${i}`);
                }
                return getUnusedQuestion(theme, difficulty);
            }
            
            const randomIndex = Math.floor(Math.random() * availableQuestions.length);
            const question = availableQuestions[randomIndex];
            const originalIndex = themeQuestions.indexOf(question);
            gameState.usedQuestions.add(`${prefix}${theme}-${originalIndex}`);
            
            return question;
        }
        
        // Afficher le modal du prochain joueur
        function showNextPlayerModal() {
            const player = gameState.players[gameState.currentPlayer];
            document.getElementById('nextPlayerName').textContent = `${player.icon} ${player.name}`;
            document.getElementById('nextPlayerModal').style.display = 'flex';
        }
        
        // Commencer le tour
        function startTurn() {
            document.getElementById('nextPlayerModal').style.display = 'none';
            const player = gameState.players[gameState.currentPlayer];
            document.getElementById('currentPlayer').textContent = `${player.icon} ${player.name}`;
            
            // Réinitialiser l'interface
            document.getElementById('dice').style.display = 'block';
            document.getElementById('diceDisplay').textContent = '🎲';
            document.getElementById('themeDisplay').style.display = 'none';
            document.getElementById('questionBtn').style.display = 'none';
            document.getElementById('questionDisplay').style.display = 'none';
            document.getElementById('timer').style.display = 'none';
            document.getElementById('answerResult').style.display = 'none';
            document.getElementById('nextTurnBtn').style.display = 'none';
            
            gameState.phase = 'dice';
            updatePlayersInfo();
        }
        
        // Lancer le dé avec animation
        function rollDice() {
            if (gameState.phase !== 'dice') return;
            
            const dice = document.getElementById('dice');
            const diceDisplay = document.getElementById('diceDisplay');
            const diceValues = dice.querySelectorAll('.dice-values span');
            
            dice.classList.add('rolling');
            diceDisplay.style.display = 'none';
            
            // Animation des chiffres
            diceValues.forEach((span, index) => {
                span.style.animationDelay = `${index * 0.1}s`;
            });
            
            setTimeout(() => {
                gameState.diceValue = Math.floor(Math.random() * 6) + 1;
                diceDisplay.textContent = gameState.diceValue;
                diceDisplay.style.display = 'block';
                dice.classList.remove('rolling');
                dice.style.display = 'none';
                
                addEvent(`${gameState.players[gameState.currentPlayer].name} a fait ${gameState.diceValue}`);
                
                // Déplacer le joueur
                movePlayer();
            }, 600);
        }
        
        // Déplacer le joueur
        function movePlayer() {
            const player = gameState.players[gameState.currentPlayer];
            const targetPosition = Math.min(player.position + gameState.diceValue, BOARD_SIZE - 1);
            
            // Animation du déplacement
            let currentPos = player.position;
            const moveInterval = setInterval(() => {
                if (currentPos < targetPosition) {
                    currentPos++;
                    player.position = currentPos;
                    updatePlayerPositions();
                } else {
                    clearInterval(moveInterval);
                    
                    // Vérifier si victoire
                    if (player.position === BOARD_SIZE - 1) {
                        setTimeout(() => endGame(player), 1000);
                        return;
                    }
                    
                    // Vérifier la case
                    const cellType = gameState.boardLayout[player.position];
                    if (cellType === 'special') {
                        handleSpecialCell();
                    } else if (cellType === 'gold') {
                        // Case choix - afficher le modal
                        document.getElementById('choiceModal').style.display = 'flex';
                        gameState.phase = 'choice';
                    } else {
                        // Afficher le thème
                        const color = cellType;
                        gameState.currentTheme = color;
                        gameState.currentDifficulty = 'normal';
                        const themes = {
                            blue: "🌍 Géographie",
                            green: "🔢 Calcul mental",
                            yellow: "🏳️ Drapeaux",
                            purple: "🎌 Anime",
                            brown: "🎮 Jeux vidéo",
                            orange: "⭐ Célébrités",
                            red: "💀 Piège Difficile!"
                        };
                        
                        document.getElementById('themeDisplay').textContent = themes[color];
                        document.getElementById('themeDisplay').style.display = 'block';
                        document.getElementById('questionBtn').style.display = 'block';
                        gameState.phase = 'theme';
                    }
                }
            }, 200);
        }
        
        // Sélectionner la difficulté (case choix)
        function selectDifficulty(difficulty) {
            document.getElementById('choiceModal').style.display = 'none';
            
            // Sélectionner un thème aléatoire
            const normalColors = CELL_COLORS.filter(c => c !== 'gold' && c !== 'red');
            gameState.currentTheme = normalColors[Math.floor(Math.random() * normalColors.length)];
            gameState.currentDifficulty = difficulty;
            
            const themes = {
                blue: "🌍 Géographie",
                green: "🔢 Calcul mental",
                yellow: "🏳️ Drapeaux",
                purple: "🎌 Anime",
                brown: "🎮 Jeux vidéo",
                orange: "⭐ Célébrités"
            };
            
            const difficultyText = difficulty === 'hard' ? ' (Difficile)' : ' (Facile)';
            document.getElementById('themeDisplay').textContent = themes[gameState.currentTheme] + difficultyText;
            document.getElementById('themeDisplay').style.display = 'block';
            document.getElementById('questionBtn').style.display = 'block';
            gameState.phase = 'theme';
        }
        
        // Afficher la question
        function showQuestion() {
            if (gameState.phase !== 'theme') return;
            
            document.getElementById('questionBtn').style.display = 'none';
            
            gameState.currentQuestion = getUnusedQuestion(gameState.currentTheme, gameState.currentDifficulty);
            
            document.getElementById('questionDisplay').textContent = gameState.currentQuestion.q;
            document.getElementById('questionDisplay').style.display = 'block';
            document.getElementById('timer').style.display = 'block';
            
            gameState.phase = 'question';
            
            // Timer de 5 secondes (8 pour les questions difficiles)
            let timeLeft = gameState.currentDifficulty === 'hard' ? 8 : 5;
            document.getElementById('timer').textContent = timeLeft;
            
            const timerInterval = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    showAnswer();
                }
            }, 1000);
        }
        
        // Afficher la réponse
        function showAnswer() {
            document.getElementById('timer').style.display = 'none';
            document.getElementById('questionDisplay').style.display = 'none';
            
            const player = gameState.players[gameState.currentPlayer];
            // Probabilité de succès selon la difficulté
            const successRate = gameState.currentDifficulty === 'hard' ? 0.3 : 0.6;
            const correct = Math.random() < successRate;
            
            if (correct) {
                player.correct++;
                // Points selon la difficulté
                const points = gameState.currentDifficulty === 'hard' ? 30 : 10;
                player.score += points;
                document.getElementById('answerResult').className = 'answer-result correct';
                document.getElementById('answerResult').textContent = `✓ Bonne réponse! La réponse était: ${gameState.currentQuestion.a} (+${points} points)`;
                addEvent(`✅ ${player.name} répond correctement et gagne ${points} points!`);
            } else {
                player.wrong++;
                document.getElementById('answerResult').className = 'answer-result wrong';
                document.getElementById('answerResult').textContent = `✗ Mauvaise réponse! La réponse était: ${gameState.currentQuestion.a}`;
                
                // Reculer selon la difficulté et le type de case
                let penalty = 1;
                if (gameState.currentTheme === 'red') {
                    penalty = 3;
                } else if (gameState.currentDifficulty === 'hard') {
                    penalty = 2;
                }
                
                player.position = Math.max(0, player.position - penalty);
                updatePlayerPositions();
                addEvent(`❌ ${player.name} se trompe et recule de ${penalty} case(s)!`);
            }
            
            document.getElementById('answerResult').style.display = 'block';
            updatePlayersInfo();
            
            document.getElementById('nextTurnBtn').style.display = 'block';
            gameState.phase = 'nextTurn';
        }currentQuestion.a}`;
                addEvent(`✅ ${player.name} répond correctement!`);
            } else {
                player.wrong++;
                document.getElementById('answerResult').className = 'answer-result wrong';
                document.getElementById('answerResult').textContent = `✗ Mauvaise réponse! La réponse était: ${gameState.currentQuestion.a}`;
                
                // Reculer
                const penalty = gameState.currentTheme === 'red' ? 3 : 1;
                player.position = Math.max(0, player.position - penalty);
                updatePlayerPositions();
                addEvent(`❌ ${player.name} se trompe et recule de ${penalty} case(s)!`);
            }
            
            document.getElementById('answerResult').style.display = 'block';
            updatePlayersInfo();
            
            document.getElementById('nextTurnBtn').style.display = 'block';
            gameState.phase = 'nextTurn';
        }
        
        // Gérer les cases spéciales
        function handleSpecialCell() {
            const player = gameState.players[gameState.currentPlayer];
            const events = [
                { 
                    text: "🍀 Case Chance! Avance de 5 cases!", 
                    effect: () => { 
                        player.position = Math.min(player.position + 5, BOARD_SIZE - 1);
                        updatePlayerPositions();
                    }
                },
                { 
                    text: "😈 Case Malchance! Recule de 3 cases!", 
                    effect: () => { 
                        player.position = Math.max(0, player.position - 3);
                        updatePlayerPositions();
                    }
                },
                { 
                    text: "💰 Case Bonus! Gagne 30 points!", 
                    effect: () => { 
                        player.score += 30;
                    }
                },
                { 
                    text: "🔄 Case Téléportation! Échange de place!", 
                    effect: () => {
                        if (gameState.players.length > 1) {
                            const others = gameState.players.filter(p => p.id !== player.id);
                            const target = others[Math.floor(Math.random() * others.length)];
                            const temp = player.position;
                            player.position = target.position;
                            target.position = temp;
                            updatePlayerPositions();
                            addEvent(`${player.name} échange avec ${target.name}!`);
                        }
                    }
                },
                {
                    text: "🚀 Case Turbo! Relance le dé!",
                    effect: () => {
                        addEvent(`${player.name} peut relancer le dé!`);
                        // Permettre de relancer
                        setTimeout(() => {
                            gameState.phase = 'dice';
                            document.getElementById('dice').style.display = 'block';
                            document.getElementById('diceDisplay').textContent = '🎲';
                            document.getElementById('nextTurnBtn').style.display = 'none';
                            document.getElementById('answerResult').style.display = 'none';
                        }, 1500);
                        return true; // Indique qu'on ne passe pas au tour suivant
                    }
                }
            ];
            
            const event = events[Math.floor(Math.random() * events.length)];
            addEvent(`${player.name}: ${event.text}`);
            const skipNextTurn = event.effect();
            
            if (!skipNextTurn) {
                document.getElementById('themeDisplay').textContent = "⭐ Case Spéciale! ⭐";
                document.getElementById('themeDisplay').style.display = 'block';
                document.getElementById('answerResult').className = 'answer-result correct';
                document.getElementById('answerResult').textContent = event.text;
                document.getElementById('answerResult').style.display = 'block';
                document.getElementById('nextTurnBtn').style.display = 'block';
            }
            
            updatePlayersInfo();
            gameState.phase = skipNextTurn ? 'dice' : 'nextTurn';
        }
        
        // Préparer le tour suivant
        function prepareNextTurn() {
            gameState.currentPlayer = (gameState.currentPlayer + 1) % gameState.players.length;
            showNextPlayerModal();
        }
        
        // Mise à jour des positions
        function updatePlayerPositions() {
            // Retirer tous les joueurs
            document.querySelectorAll('.player').forEach(p => p.remove());
            
            // Grouper les joueurs par position
            const playersByPosition = {};
            gameState.players.forEach(player => {
                if (!playersByPosition[player.position]) {
                    playersByPosition[player.position] = [];
                }
                playersByPosition[player.position].push(player);
            });
            
            // Placer les joueurs
            Object.keys(playersByPosition).forEach(position => {
                const playersAtPosition = playersByPosition[position];
                const cell = document.getElementById(`cell-${position}`);
                
                playersAtPosition.forEach((player, index) => {
                    const playerDiv = document.createElement('div');
                    playerDiv.className = `player player${player.id}`;
                    playerDiv.textContent = player.icon;
                    playerDiv.id = `player-${player.id}`;
                    
                    // Ajuster la position si plusieurs joueurs sur la même case
                    if (playersAtPosition.length > 1) {
                        playerDiv.style.transform = `scale(0.8)`;
                        if (playersAtPosition.length === 2) {
                            playerDiv.style[index === 0 ? 'left' : 'right'] = '-4px';
                        }
                    }
                    
                    cell.appendChild(playerDiv);
                });
            });
        }
        
        // Mise à jour des infos joueurs
        function updatePlayersInfo() {
            const playersInfo = document.getElementById('playersInfo');
            playersInfo.innerHTML = '';
            
            gameState.players.forEach((player, index) => {
                const playerInfo = document.createElement('div');
                playerInfo.className = 'player-info';
                if (index === gameState.currentPlayer) {
                    playerInfo.classList.add('active');
                }
                
                playerInfo.innerHTML = `
                    <div>
                        <div class="player-name">${player.icon} ${player.name}</div>
                        <div class="player-stats">Case ${player.position} | Score: ${player.score} | ✓ ${player.correct} ✗ ${player.wrong}</div>
                    </div>
                `;
                playersInfo.appendChild(playerInfo);
            });
        }
        
        // Ajouter un événement
        function addEvent(text) {
            const eventLog = document.getElementById('eventLog');
            const event = document.createElement('div');
            event.className = 'event recent';
            event.textContent = `${new Date().toLocaleTimeString()} - ${text}`;
            eventLog.insertBefore(event, eventLog.firstChild);
            
            const events = eventLog.querySelectorAll('.event');
            events.forEach((e, i) => {
                if (i > 0) e.classList.remove('recent');
            });
            
            if (events.length > 15) {
                eventLog.removeChild(events[events.length - 1]);
            }
        }
        
        // Fin du jeu
        function endGame(winner) {
            // Calculer les statistiques
            const totalQuestions = winner.correct + winner.wrong;
            const accuracy = totalQuestions > 0 ? Math.round((winner.correct / totalQuestions) * 100) : 0;
            
            document.getElementById('winnerName').innerHTML = `
                <h2>${winner.icon} ${winner.name} a gagné! 🎉</h2>
                <p style="font-size: 1.2em; margin: 10px 0;">Score final: <strong>${winner.score}</strong> points</p>
                <p>Bonnes réponses: <span style="color: #27ae60;">${winner.correct}</span></p>
                <p>Mauvaises réponses: <span style="color: #e74c3c;">${winner.wrong}</span></p>
                <p>Précision: <strong>${accuracy}%</strong></p>
            `;
            document.getElementById('winnerModal').style.display = 'flex';
            addEvent(`🏆 ${winner.name} remporte la partie avec ${winner.score} points!`);
        }
        
        // Réinitialiser le jeu
        function resetGame() {
            gameState = {
                players: [],
                currentPlayer: 0,
                currentQuestion: null,
                currentTheme: null,
                diceValue: 0,
                board: [],
                phase: 'setup',
                playerCount: 0,
                usedQuestions: new Set(),
                boardLayout: []
            };
            
            document.getElementById('winnerModal').style.display = 'none';
            document.getElementById('setupModal').style.display = 'flex';
            document.getElementById('eventLog').innerHTML = '';
            document.getElementById('playerSetupContainer').innerHTML = '';
            document.getElementById('startGameBtn').style.display = 'none';
        }
        
        // Initialisation
        window.onload = function() {
            document.getElementById('setupModal').style.display = 'flex';
        };
    </script>
</body>
</html><!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grey Goose - Jeu de Plateau</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            color: #fff;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .setup-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .setup-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            min-width: 450px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .setup-content h2 {
            color: #fff;
            margin-bottom: 30px;
            font-size: 2em;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .player-setup {
            margin: 20px 0;
            text-align: left;
        }

        .player-setup input {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .player-setup input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.15);
            border-color: #3498db;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
        }

        .player-count-selector {
            margin: 30px 0;
        }

        .player-count-selector button {
            margin: 0 5px;
            padding: 12px 25px;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);
        }

        .player-count-selector button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.6);
        }

        .game-container {
            display: flex;
            gap: 15px;
            padding: 15px;
            max-width: 100%;
            margin: 0 auto;
            height: calc(100vh - 30px);
        }

        .board-section {
            flex: 1;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            overflow: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .info-section {
            width: 340px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            overflow-y: auto;
        }

        .panel {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        h1 {
            text-align: center;
            color: #fff;
            margin-bottom: 15px;
            font-size: 1.8em;
            text-shadow: 0 0 30px rgba(255, 255, 255, 0.5);
            letter-spacing: 2px;
        }

        h2 {
            color: #aaa;
            margin-bottom: 12px;
            font-size: 1.1em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .board {
            display: grid;
            grid-template-columns: repeat(20, 30px);
            gap: 2px;
            margin: 0 auto;
            width: fit-content;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }

        .cell {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            font-weight: bold;
            position: relative;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 0, 0, 0.2);
        }

        .cell:hover {
            transform: translateY(-3px) scale(1.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            z-index: 5;
        }

        .cell.blue { 
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }
        .cell.green { 
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
        }
        .cell.yellow { 
            background: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%);
            color: #333;
        }
        .cell.purple { 
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
        }
        .cell.brown { 
            background: linear-gradient(135deg, #8b4513 0%, #654321 100%);
            color: white;
        }
        .cell.orange { 
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
            color: white;
        }
        .cell.red { 
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }
        .cell.special { 
            background: linear-gradient(135deg, #ff6b6b 0%, #4ecdc4 50%, #ffe66d 100%);
            animation: sparkle 3s infinite;
            color: #333;
            font-weight: bold;
        }

        .choice-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .choice-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            animation: fadeIn 0.5s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .choice-title {
            font-size: 2em;
            margin-bottom: 30px;
            color: #FFD700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }

        .choice-buttons {
            display: flex;
            gap: 30px;
            justify-content: center;
            margin-top: 30px;
        }

        .choice-button {
            padding: 20px 40px;
            font-size: 1.2em;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .choice-button.easy {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            box-shadow: 0 5px 20px rgba(46, 204, 113, 0.4);
        }

        .choice-button.easy:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.6);
        }

        .choice-button.hard {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            box-shadow: 0 5px 20px rgba(231, 76, 60, 0.4);
        }

        .choice-button.hard:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.6);
        }

        .difficulty-info {
            margin: 20px 0;
            font-size: 1.1em;
            color: #bbb;
        }

        @keyframes sparkle {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
            }
        }

        .player {
            position: absolute;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            z-index: 10;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(255, 255, 255, 0.8);
        }

        .player1 { 
            background: linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%);
            top: -4px; left: -4px;
        }
        .player2 { 
            background: linear-gradient(135deg, #4ecdc4 0%, #44a39d 100%);
            top: -4px; right: -4px;
        }
        .player3 { 
            background: linear-gradient(135deg, #feca57 0%, #ff9a00 100%);
            bottom: -4px; left: -4px;
        }
        .player4 { 
            background: linear-gradient(135deg, #48dbfb 0%, #0abde3 100%);
            bottom: -4px; right: -4px;
        }

        .dice {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            margin: 15px auto;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .dice::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: rotate(45deg);
            transition: all 0.5s;
            opacity: 0;
        }

        .dice:hover::before {
            animation: shine 0.5s ease;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); opacity: 0; }
        }

        .dice:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6);
        }

        .dice.rolling {
            animation: roll 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes roll {
            0% { transform: rotate(0deg) scale(1); }
            25% { transform: rotate(90deg) scale(1.1); }
            50% { transform: rotate(180deg) scale(1.2); }
            75% { transform: rotate(270deg) scale(1.1); }
            100% { transform: rotate(360deg) scale(1); }
        }

        .dice-values {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
        }

        .dice-values span {
            position: absolute;
            opacity: 0;
            animation: none;
        }

        .dice.rolling .dice-values span {
            animation: diceNumber 0.6s ease;
        }

        @keyframes diceNumber {
            0%, 100% { opacity: 0; transform: scale(0.5); }
            50% { opacity: 1; transform: scale(1); }
        }

        .current-player {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            border-radius: 10px;
            margin-bottom: 12px;
            font-size: 1.2em;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .action-panel {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            border-radius: 12px;
            min-height: 250px;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .theme-display {
            font-size: 1.3em;
            margin: 15px 0;
            padding: 15px;
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .question-display {
            font-size: 1.15em;
            margin: 15px 0;
            padding: 20px;
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            border-radius: 10px;
            min-height: 80px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            line-height: 1.5;
        }

        .timer {
            font-size: 3em;
            margin: 15px 0;
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            border-radius: 50%;
            margin: 15px auto;
            box-shadow: 0 5px 20px rgba(231, 76, 60, 0.5);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .answer-result {
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            font-size: 1.15em;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.3);
        }

        .answer-result.correct {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .answer-result.wrong {
            background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .players-info {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .player-info {
            padding: 12px;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .player-info.active {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            border: 1px solid #3498db;
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.5);
            transform: translateX(5px);
        }

        .player-name {
            font-weight: bold;
            font-size: 1.05em;
        }

        .player-stats {
            font-size: 0.85em;
            color: #bbb;
        }

        .event-log {
            max-height: 150px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            font-size: 0.85em;
        }

        .event {
            padding: 5px 10px;
            margin-bottom: 5px;
            font-size: 0.85em;
            opacity: 0.7;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.05);
        }

        .event.recent {
            opacity: 1;
            font-weight: bold;
            background: rgba(52, 152, 219, 0.2);
        }

        button {
            padding: 12px 25px;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            margin: 5px;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
        }

        button:hover {
            background: linear-gradient(135deg, #2980b9 0%, #21618c 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.5);
        }

        button:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(52, 152, 219, 0.3);
        }

        button:disabled {
            background: linear-gradient(135deg, #555 0%, #333 100%);
            cursor: not-allowed;
            box-shadow: none;
        }

        button.big-button {
            padding: 18px 40px;
            font-size: 1.2em;
            margin: 15px auto;
            display: block;
        }

        .winner-modal, .next-player-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .winner-content, .next-player-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            animation: fadeIn 0.5s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.8) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .winner-title {
            font-size: 2em;
            margin-bottom: 20px;
            color: #ffd700;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
        }

        .next-player-name {
            font-size: 2.5em;
            margin: 25px 0;
            color: #3498db;
            text-shadow: 0 0 20px rgba(52, 152, 219, 0.5);
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(52, 152, 219, 0.5);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(52, 152, 219, 0.7);
        }
    </style>
</head>
<body>
    <!-- Modal de configuration -->
    <div class="setup-modal" id="setupModal">
        <div class="setup-content">
            <h2>🎲 Configuration de la partie 🎲</h2>
            <div class="player-count-selector">
                <p style="margin-bottom: 15px;">Nombre de joueurs:</p>
                <button onclick="setPlayerCount(2)">2 Joueurs</button>
                <button onclick="setPlayerCount(3)">3 Joueurs</button>
                <button onclick="setPlayerCount(4)">4 Joueurs</button>
            </div>
            <div id="playerSetupContainer"></div>
            <button onclick="startNewGame()" style="display: none;" id="startGameBtn" class="big-button">Commencer la partie</button>
        </div>
    </div>

    <!-- Modal du prochain joueur -->
    <div class="next-player-modal" id="nextPlayerModal">
        <div class="next-player-content">
            <h2>Prochain tour</h2>
            <div class="next-player-name" id="nextPlayerName"></div>
            <button class="big-button" onclick="startTurn()">Prêt!</button>
        </div>
    </div>

    <!-- Modal de choix de difficulté -->
    <div class="choice-modal" id="choiceModal">
        <div class="choice-content">
            <div class="choice-title">🏆 Case Choix 🏆</div>
            <div class="difficulty-info">Choisissez votre niveau de difficulté</div>
            <div class="choice-buttons">
                <button class="choice-button easy" onclick="selectDifficulty('easy')">
                    <div>Question Facile</div>
                    <small>+10 points si correct</small>
                </button>
                <button class="choice-button hard" onclick="selectDifficulty('hard')">
                    <div>Question Difficile</div>
                    <small>+30 points si correct<br>-2 cases si erreur</small>
                </button>
            </div>
        </div>
    </div>

    <!-- Contenu principal du jeu -->
    <div class="game-container">
        <div class="board-section">
            <h1>🎲 Grey Goose 🎲</h1>
            <div class="board" id="board"></div>
        </div>
        
        <div class="info-section">
            <div class="panel">
                <h2>Tour en cours</h2>
                <div class="current-player" id="currentPlayer">Configuration...</div>
                <div class="action-panel">
                    <div class="dice" id="dice" onclick="rollDice()">
                        <div class="dice-values">
                            <span>1</span>
                            <span>2</span>
                            <span>3</span>
                            <span>4</span>
                            <span>5</span>
                            <span>6</span>
                        </div>
                        <span id="diceDisplay">🎲</span>
                    </div>
                    <div class="theme-display" id="themeDisplay" style="display: none;"></div>
                    <button class="big-button" id="questionBtn" style="display: none;" onclick="showQuestion()">Poser la question</button>
                    <div class="question-display" id="questionDisplay" style="display: none;"></div>
                    <div class="timer" id="timer" style="display: none;">5</div>
                    <div class="answer-result" id="answerResult" style="display: none;"></div>
                    <button class="big-button" id="nextTurnBtn" style="display: none;" onclick="prepareNextTurn()">Tour suivant</button>
                </div>
            </div>
            
            <div class="panel">
                <h2>Joueurs</h2>
                <div class="players-info" id="playersInfo"></div>
            </div>
            
            <div class="panel">
                <h2>Journal des événements</h2>
                <div class="event-log" id="eventLog"></div>
            </div>
        </div>
    </div>
    
    <div class="winner-modal" id="winnerModal">
        <div class="winner-content">
            <div class="winner-title">🏆 Victoire! 🏆</div>
            <div id="winnerName"></div>
            <button onclick="resetGame()" class="big-button">Nouvelle partie</button>
        </div>
    </div>

    <script>
        // Configuration du jeu
        const BOARD_SIZE = 150;
        const CELL_COLORS = ['blue', 'green', 'yellow', 'purple', 'brown', 'orange', 'red', 'gold'];
        const SPECIAL_CELLS = [15, 30, 45, 60, 75, 90, 105, 120, 135];
        const CHOICE_CELLS = [10, 25, 40, 55, 70, 85, 100, 115, 130, 145];
        
        // Questions par thème avec beaucoup plus de variété
        const questions = {
            blue: [ // Géographie
                { q: "Quelle est la capitale de la France?", a: "Paris" },
                { q: "Quel est le plus grand océan?", a: "Pacifique" },
                { q: "Combien y a-t-il de continents?", a: "7" },
                { q: "Quelle est la plus haute montagne?", a: "Everest" },
                { q: "Quel est le plus long fleuve?", a: "Nil" },
                { q: "Quelle est la capitale du Japon?", a: "Tokyo" },
                { q: "Dans quel pays se trouve la tour Eiffel?", a: "France" },
                { q: "Quel est le plus petit pays du monde?", a: "Vatican" },
                { q: "Quelle est la capitale de l'Australie?", a: "Canberra" },
                { q: "Quel est le plus grand désert du monde?", a: "Antarctique" },
                { q: "Combien d'océans y a-t-il?", a: "5" },
                { q: "Quelle est la capitale de l'Espagne?", a: "Madrid" },
                { q: "Dans quel pays se trouve le Machu Picchu?", a: "Pérou" },
                { q: "Quel est le plus grand pays du monde?", a: "Russie" },
                { q: "Quelle est la capitale de l'Italie?", a: "Rome" },
                { q: "Sur quel continent se trouve l'Égypte?", a: "Afrique" },
                { q: "Quelle est la capitale du Canada?", a: "Ottawa" },
                { q: "Quel est le plus grand lac du monde?", a: "Caspienne" },
                { q: "Dans quel pays se trouve la Grande Muraille?", a: "Chine" },
                { q: "Quelle est la capitale de l'Allemagne?", a: "Berlin" },
                { q: "Quel est le plus peuplé des continents?", a: "Asie" },
                { q: "Quelle est la capitale du Brésil?", a: "Brasilia" },
                { q: "Dans quel pays se trouve le Taj Mahal?", a: "Inde" },
                { q: "Quelle est la capitale de la Russie?", a: "Moscou" },
                { q: "Quel est le plus grand archipel du monde?", a: "Indonésie" },
                { q: "Quelle est la capitale de la Suède?", a: "Stockholm" },
                { q: "Dans quel pays se trouve la Sagrada Familia?", a: "Espagne" },
                { q: "Quelle est la capitale de la Grèce?", a: "Athènes" },
                { q: "Quel est le point le plus bas sur Terre?", a: "Mer Morte" },
                { q: "Quelle est la capitale du Mexique?", a: "Mexico" }
            ],
            green: [ // Calcul mental
                { q: "Combien font 15 × 6?", a: "90" },
                { q: "Combien font 144 ÷ 12?", a: "12" },
                { q: "Combien font 73 + 89?", a: "162" },
                { q: "Combien font 25²?", a: "625" },
                { q: "Combien font 1000 - 337?", a: "663" },
                { q: "Combien font 8 × 9?", a: "72" },
                { q: "Combien font 156 ÷ 4?", a: "39" },
                { q: "Combien font 17 + 28?", a: "45" },
                { q: "Combien font 7 × 8?", a: "56" },
                { q: "Combien font 99 + 99?", a: "198" },
                { q: "Combien font 12 × 12?", a: "144" },
                { q: "Combien font 500 - 175?", a: "325" },
                { q: "Combien font 18 × 5?", a: "90" },
                { q: "Combien font 225 ÷ 15?", a: "15" },
                { q: "Combien font 64 + 77?", a: "141" },
                { q: "Combien font 11 × 11?", a: "121" },
                { q: "Combien font 1000 ÷ 25?", a: "40" },
                { q: "Combien font 88 + 77?", a: "165" },
                { q: "Combien font 13 × 7?", a: "91" },
                { q: "Combien font 360 ÷ 12?", a: "30" },
                { q: "Combien font 45 + 67?", a: "112" },
                { q: "Combien font 14 × 6?", a: "84" },
                { q: "Combien font 800 - 456?", a: "344" },
                { q: "Combien font 16²?", a: "256" },
                { q: "Combien font 243 ÷ 9?", a: "27" },
                { q: "Combien font 19 × 4?", a: "76" },
                { q: "Combien font 125 + 75?", a: "200" },
                { q: "Combien font 21 × 3?", a: "63" },
                { q: "Combien font 648 ÷ 8?", a: "81" },
                { q: "Combien font 37 + 84?", a: "121" }